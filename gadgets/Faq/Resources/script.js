/** * FAQ Javascript actions * * @category   Ajax * @package    Faq * @author     Pablo Fischer <pablo@pablo.com.mx> * @copyright  2005-2015 Jaws Development Group * @license    http://www.gnu.org/copyleft/gpl.html *//** * Use async mode, create Callback */var FaqCallback = {    InsertQuestion: function (response) {        if (response['type'] == 'alert-success') {            getDG('questions_datagrid', $('#questions_datagrid')[0].getCurrentPage(), true);            stopAction();        }        FaqAjax.showResponse(response);    },    UpdateQuestion: function (response) {        if (response['type'] == 'alert-success') {            getDG('questions_datagrid', $('#questions_datagrid')[0].getCurrentPage(), true);            stopAction();        }        FaqAjax.showResponse(response);    },    DeleteQuestion: function(response) {        if (response['type'] == 'alert-success') {            getDG('questions_datagrid', $('#questions_datagrid')[0].getCurrentPage(), true);            stopAction();        }        FaqAjax.showResponse(response);    },    MoveQuestion: function(response) {        if (response['type'] == 'alert-success') {            getDG('questions_datagrid', $('#questions_datagrid')[0].getCurrentPage(), true);        }        FaqAjax.showResponse(response);    },    InsertCategory: function (response) {        if (response['type'] == 'alert-success') {            getDG('categories_datagrid', $('#categories_datagrid')[0].getCurrentPage(), true);            stopAction();        }        FaqAjax.showResponse(response);    },    UpdateCategory: function (response) {        if (response['type'] == 'alert-success') {            getDG('categories_datagrid', $('#categories_datagrid')[0].getCurrentPage(), true);            stopAction();        }        FaqAjax.showResponse(response);    },    DeleteCategory: function(response) {        if (response['type'] == 'alert-success') {            getDG('categories_datagrid', $('#categories_datagrid')[0].getCurrentPage(), true);            stopAction();        }        FaqAjax.showResponse(response);    },    MoveCategory: function(response) {        if (response['type'] == 'alert-success') {            getDG('categories_datagrid', $('#categories_datagrid')[0].getCurrentPage(), true);        }        FaqAjax.showResponse(response);    }}/** * Stops doing a certain action */function stopAction() {    switch (currentAction) {        case 'Questions' :            $('#legend_title').html(addQuestion_title);            selectedQuestion = null;            // setEditorValue('#answer', '');            $('#question').val('');            $('#category').val(0);            $('#fast_url').val('');            $('#meta_keywords').val('');            $('#meta_description').val('');            $('#published').val(0);            unselectGridRow('questions_datagrid');            break;        case 'Categories' :            $('#legend_title').html(addCategory_title);            selectedCategory = null;            $('#title').val('');            $('#fast_url').val('');            $('#meta_keywords').val('');            $('#meta_description').val('');            $('#description').val('');            unselectGridRow('categories_datagrid');            break;    }}/** * Fetches questions data to fills the data grid */function getQuestionsDataGrid(name, offset, reset){    var questions = FaqAjax.callSync('GetQuestions', {'offset': offset, 'category': $('#category_filter').val()});    if (reset) {        stopAction();        $('#'+name)[0].setCurrentPage(0);        var total = FaqAjax.callSync('GetQuestionsCount', $('#category_filter').val());    }    resetGrid(name, questions, total);}/** * Fetches categories data to fills the data grid */function getCategories(name, offset, reset){    var categories = FaqAjax.callSync('GetCategories');    resetGrid(name, categories);}/** * Edit a question */function editQuestion(rowElement, id) {    stopAction();    selectGridRow('questions_datagrid', rowElement.parentNode.parentNode);    selectedQuestion = id;    $('#legend_title').html(editQuestion_title);    var question = FaqAjax.callSync('GetQuestion', {'id': id});    setEditorValue('#answer', question['answer']);    $('#question').val(question['question']);    $('#category').val(question['category_id']);    $('#fast_url').val(question['fast_url']);    $('#meta_keywords').val(question['meta_keywords']);    $('#meta_description').val(question['meta_description']);    if(question['published']) {        $('#published').val(1);    } else {        $('#published').val(0);    }}/** * Edit a category */function editCategory(rowElement, id) {    stopAction();    selectGridRow('categories_datagrid', rowElement.parentNode.parentNode);    selectedCategory = id;    $('#legend_title').html(editCategory_title);    var category = FaqAjax.callSync('GetCategory', {'id': id});    $('#title').val(category['category']);    $('#fast_url').val(category['fast_url']);    $('#meta_keywords').val(category['meta_keywords']);    $('#meta_description').val(category['meta_description']);    $('#description').val(category['description']);}/** * Saves data / changes */function saveQuestion(){    var answer = getEditorValue('#answer');    if (!$('#question').val() || answer == '')    {        alert(incompleteQuestionFields);        return false;    }    if (selectedQuestion == null) {        FaqAjax.callAsync(            'InsertQuestion', {                'data': {                    'question': $('#question').val(),                    'answer': answer,                    'category': $('#category').val(),                    'fast_url': $('#fast_url').val(),                    'meta_keywords': $('#meta_keywords').val(),                    'meta_description': $('#meta_description').val(),                    'published': $('#published').val()                }            }        );    } else {        FaqAjax.callAsync(            'UpdateQuestion', {                'id': selectedQuestion,                'data': {                    'question': $('#question').val(),                    'answer': answer,                    'category': $('#category').val(),                    'fast_url': $('#fast_url').val(),                    'meta_keywords': $('#meta_keywords').val(),                    'meta_description': $('#meta_description').val(),                    'published': $('#published').val()                }            }        );    }}/** * Saves data / changes */function saveCategory(){    if (!$('#title').val())    {        alert(incompleteCategoryFields);        return false;    }    if (selectedCategory == null) {        FaqAjax.callAsync(            'InsertCategory', {                'data': {                    'category': $('#title').val(),                    'description': $('#description').val(),                    'fast_url': $('#fast_url').val(),                    'meta_keywords': $('#meta_keywords').val(),                    'meta_description': $('#meta_description').val()                }            }        );    } else {        FaqAjax.callAsync(            'UpdateCategory', {                'id': selectedCategory,                'data': {                    'category': $('#title').val(),                    'description': $('#description').val(),                    'fast_url': $('#fast_url').val(),                    'meta_keywords': $('#meta_keywords').val(),                    'meta_description': $('#meta_description').val()                }            }        );    }}/** * Delete a question */function deleteQuestion(rowElement, id){    stopAction();    if (confirm(confirmQuestionDelete)) {        selectGridRow('servers_datagrid', rowElement.parentNode.parentNode);        FaqAjax.callAsync('DeleteQuestion', {'id': id});    }}/** * Delete a category */function deleteCategory(rowElement, id){    stopAction();    if (confirm(confirmCategoryDelete)) {        selectGridRow('categories_datagrid', rowElement.parentNode.parentNode);        FaqAjax.callAsync('DeleteCategory', {'id': id});    }}/** * Move a question */function moveQuestion(category, id, position, direction){    if (position == 1 && direction < 0) {        return;    }    FaqAjax.callAsync('MoveQuestion', {'category': category, 'id': id, 'position': position, 'direction': direction});}/** * Move a category */function moveCategory(id, position, direction){    if (position == 1 && direction < 0) {        return;    }    FaqAjax.callAsync('MoveCategory', {'id': id, 'old_pos': position, 'new_pos': position + direction});}var FaqAjax = new JawsAjax('Faq', FaqCallback);var currentAction = null,    selectedQuestion = null,    selectedCategory = null;faqSortable = null;